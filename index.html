<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Авторизация</title>

  <!-- Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <!-- Facebook SDK -->
  <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js"></script>

  <style>
    body {
      background: linear-gradient(to bottom right, #e3f2fd, #ffffff);
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 60px 20px;
      color: #333;
    }
    h1 {
      margin-bottom: 20px;
    }
    p {
      margin-bottom: 30px;
    }
    .login-button {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      width: 280px;
      margin: 10px auto;
      padding: 12px;
      font-size: 16px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .login-button:hover {
      background-color: #45a049;
    }
    .login-button img {
      height: 20px;
    }
    .note {
      margin-top: 40px;
      font-size: 12px;
      color: #888;
    }
  </style>
</head>
<body>

  <h1>Добро пожаловать!</h1>
  <p>Пожалуйста, войдите в систему, чтобы начать пользоваться сервисом и накапливать кешбэк.</p>

  <div id="g_id_onload"
       data-client_id="634487427489-a3k2nop2pi8ffpprahnchnvbr08djhlp.apps.googleusercontent.com"
       data-context="signin"
       data-ux_mode="popup"
       data-callback="handleCredentialResponse"
       data-auto_prompt="false">
  </div>

  <div class="g_id_signin"
       data-type="standard"
       data-shape="rectangular"
       data-theme="outline"
       data-text="signin_with"
       data-size="large"
       data-logo_alignment="left">
  </div>

  <script>
    function handleCredentialResponse(response) {
      const jwt = response.credential;
      const payload = JSON.parse(atob(jwt.split('.')[1]));
      alert("Привет, " + payload.name);
      localStorage.setItem("user", JSON.stringify(payload));
      window.location.href = "profile.html";
    }
  </script>

  <button class="login-button" id="facebook-login" style="background-color:#3b5998">
    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/facebook.svg" alt="Facebook">
    Войти через Facebook
  </button>

  <button class="login-button" id="apple-login" style="background-color:#000">
    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/apple.svg" alt="Apple">
    Войти через Apple ID
  </button>

  <p class="note">Продолжая, вы соглашаетесь с нашей <a href="#">политикой конфиденциальности</a>.</p>

  <script>
    // Facebook
    window.fbAsyncInit = function () {
      FB.init({
        appId: 'ВАШ_FACEBOOK_APP_ID',
        cookie: true,
        xfbml: true,
        version: 'v19.0'
      });
    };

    document.getElementById("facebook-login").onclick = function () {
      FB.login(function (response) {
        if (response.authResponse) {
          FB.api('/me', { fields: 'name,email,picture' }, function (profile) {
            alert("Привет, " + profile.name);
            localStorage.setItem("user", JSON.stringify(profile));
            window.location.href = "profile.html";
          });
        } else {
          alert("Ошибка входа через Facebook");
        }
      }, { scope: 'public_profile,email' });
    };

    // Apple
    document.getElementById("apple-login").onclick = function () {
      const clientId = 'ВАШ_APPLE_SERVICE_ID';
      const redirectUri = encodeURIComponent(window.location.origin + '/vending-site/');
      const state = Math.random().toString(36).substring(7);
      const nonce = Math.random().toString(36).substring(7);
      const url = `https://appleid.apple.com/auth/authorize?response_type=code%20id_token&client_id=${clientId}&redirect_uri=${redirectUri}&scope=name%20email&response_mode=fragment&state=${state}&nonce=${nonce}`;
      window.location.href = url;
    };
  </script>

</body>
</html>
